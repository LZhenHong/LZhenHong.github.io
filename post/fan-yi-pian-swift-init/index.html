<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>ç¿»è¯‘ç¯‡ - Swift init() | Eden&#39;s Blog</title>

<link rel="shortcut icon" href="https://lzhenhong.github.io/favicon.ico?v=1660659286356">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://lzhenhong.github.io/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            Eden&#39;s Blog
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            é¦–é¡µ
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            å½’æ¡£
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1660659286356" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="æœç´¢æ–‡ç« " />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    ç¿»è¯‘ç¯‡ - Swift init()
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        Â· 2016-08-28 Â·
                    </time>
                    
                        <a href="https://lzhenhong.github.io/tag/Q-9LDzSZC/" class="post-tags">
                            # Swift
                        </a>
                    
                </div>
                <div class="post-content">
                    <p><em>PSï¼šç¿»è¯‘æ°´å¹³æœ‰é™ï¼Œæ¨èçœ‹åŸæ–‡</em></p>
<p><a href="http://merowing.info/2015/11/Initializers.playground.zip">ä¸‹è½½ Playgroung æ–‡ä»¶</a></p>
<p><a href="http://merowing.info/2015/11/swift-init/">åŸæ–‡é“¾æ¥.</a></p>
<p>å› ä¸º <code>Swift</code> çš„å¼ºç±»å‹å’Œä¸å¯å˜æ€§ï¼Œæ‰€ä»¥å°±æœ‰è§„åˆ™é˜²æ­¢ä½ åœ¨ä¸€ä¸ªå¯¹è±¡å®Œå…¨åˆå§‹åŒ–ä¹‹å‰è®¿é—®å±æ€§ã€‚</p>
<p>æˆ‘ä¸å–œæ¬¢åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…åšå¤ªå¤šçš„äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä¼šå°†åˆå§‹åŒ–å‡½æ•°åˆ†æˆå¤šä¸ªå‡½æ•°ï¼Œè¿™æ ·é—®é¢˜å°±æ¥äº†ã€‚</p>
<!-- more -->
<p>è®©æˆ‘ä»¬å‡å®šä½ æœ‰ä¸€ä¸ªè¿™æ ·çš„ç±»ï¼š</p>
<pre><code>class Foo {
  let coreDataStack: CoreDataStack
  let mfpService = MFPService()
  let integrator: IntegrationService
  let flowController: FlowController
  let window: UIWindow
}
</code></pre>
<p>è¿™æ ·çš„ç±»éœ€è¦è®¸å¤šè¡Œæ¥åˆå§‹åŒ–æ‰€æœ‰çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå°†åˆå§‹åŒ–é€»è¾‘åˆ†æˆå¤šä¸ªå‡½æ•°ï¼Œå¯èƒ½åƒè¿™æ ·ï¼š</p>
<pre><code>init(coreDataStack stack: CoreDataStack) {
  coreDataStack = stack
  integrator = setupIntegrator(stack, provider: mfpService)
  flowController = setupFlowController(stack)
  window = setupWindow(flowController.rootViewController)
}
</code></pre>
<p>è¿™ä»…ä»…æ˜¯å¸¸è§„çš„é‡æ„... çŒœä¸€çŒœï¼Œè¿™æ ·ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼š<br>
<img src="https://github.com/LZhenHong/BlogImages/blob/master/initializers.png?raw=true" alt="" loading="lazy"></p>
<p>è¿™æ ·æ˜¾å¾—ä¸é‚£ä¹ˆ Cool. :]</p>
<p>æˆ‘åœ¨ Twitter ä¸Šè·Ÿä¸€äº›èƒ½å¹²çš„äººäº¤æµï¼Œå¯»æ‰¾ä¸€äº›é€‰æ‹©ï¼Œä¸‹é¢æ˜¯æˆ‘è§‰å¾—æŒºå¥½çš„ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™äº›é€‰æ‹©</p>
<h2 id="é€‰æ‹©-1-å¯¹å¯é€‰å˜é‡éšå¼è§£åŒ…">é€‰æ‹© 1 - å¯¹å¯é€‰å˜é‡éšå¼è§£åŒ…</h2>
<pre><code>var integrator: IntegrationService!
</code></pre>
<p>è¿™ä¸ªé€‰æ‹©ç»å¸¸ä¼šå‡ºé”™ï¼Œæˆ‘ä»¬é€‰æ‹© <code>Swift</code> æ˜¯å› ä¸ºå®ƒèƒ½å†™å‡ºæ›´å®‰å…¨çš„ä»£ç ã€‚</p>
<p>è¯·ä¸è¦è¿™æ ·å†™ã€‚</p>
<h2 id="é€‰æ‹©-2-æœ‰å‰¯ä½œç”¨çš„æ‡’åŠ è½½">é€‰æ‹© 2 - æœ‰å‰¯ä½œç”¨çš„æ‡’åŠ è½½</h2>
<p>æˆ‘ä»¬ç”¨éšè—çš„æ‡’åŠ è½½å±æ€§ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰å‰¯ä½œç”¨</p>
<pre><code>class Foo_lazy {
  let coreDataStack: CoreDataStack
  let mfpService = MFPService()
  
  init(coreDataStack stack: CoreDataStack) {
    coreDataStack = stack
    let _ = integrator
    let _ = rootFlowController
    let _ = window
  }
  
  lazy var rootFlowController: FlowController = {
    return FlowController(coreDataStack: self.coreDataStack)
  }()
  
  lazy var window: UIWindow = {
    let window = UIWindow(frame: UIScreen.mainScreen().bounds)
    window.backgroundColor = UIColor.whiteColor()
    window.rootViewController = self.rootFlowController.rootViewController
    window.makeKeyAndVisible()
    return window
  }()
  
  
  lazy var integrator: IntegrationService = {
    let coreDataProcessor = CoreDataReportProcessor(stack: self.coreDataStack)
    let integrator = IntegrationService(provider: self.mfpService) {
      coreDataProcessor.processReports($0)
    }
    return integrator
  }()
}
</code></pre>
<p>è¿™ä¸ªè§£å†³æ–¹æ³•å…è®¸æˆ‘ä»¬å°†ä»£ç åˆ†å¼€ï¼Œå¹¶ä¸”ä¹Ÿè¿è¡Œå¾—å¾ˆå¥½ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¸æ˜¯é‚£ä¹ˆå¥½ï¼Œå› ä¸º</p>
<ul>
<li>å±æ€§ä¸æ˜¯çœŸæ­£çš„ä¸å¯å˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å®šä¹‰æˆéšç§ï¼Œå¦‚æ­¤ä¸èƒ½åœ¨å¤–é¢æ›´æ”¹å®ƒä»¬ï¼Œä½†æ˜¯ä»–ä»¬ä»ç„¶æ˜¯å¯å˜çš„ã€‚</li>
<li>æˆ‘ä¸å–œæ¬¢åƒè¿™æ ·ä¼šè§¦å‘å‰¯ä½œç”¨çš„ä»£ç ï¼Œè¿™æ ·çœ‹èµ·æ¥å¾ˆä¸æ•´æ´ã€‚</li>
</ul>
<h2 id="é€‰æ‹©-3-éšç§çš„é™æ€æ–¹æ³•">é€‰æ‹© 3 - éšç§çš„é™æ€æ–¹æ³•</h2>
<p>æˆ‘ä»¬å¯ä»¥å®šä¹‰éšç§çš„é™æ€æ–¹æ³•ï¼Œç”¨å®ƒä»¬æ¥åˆå§‹åŒ–å±æ€§(å¹¶ä¸”å¯ä»¥å°†å®ƒä»¬æ”¾åœ¨éšç§çš„ç±»æ‰©å±•ä¸­)ï¼š</p>
<pre><code>class Foo_ext {
  let coreDataStack: CoreDataStack
  let mfpService = MFPService()
  let integrator: IntegrationService
  let flowController: FlowController
  let window: UIWindow
  
  init(coreDataStack stack: CoreDataStack) {
    coreDataStack = stack
    integrator = Foo_ext.SetupIntegrator(stack, provider: self.mfpService)
    flowController = Foo_ext.SetupFlowController(stack)
    window = Foo_ext.SetupWindow(self.flowController.rootViewController)
  }
}

private extension Foo_ext {
  static func SetupIntegrator(stack: CoreDataStack, provider: Provider) -&gt; IntegrationService {
    let coreDataProcessor = CoreDataReportProcessor(stack: stack)
    let integrator = IntegrationService(provider: provider) {
      coreDataProcessor.processReports($0)
    }
    return integrator
  }
  
  static func SetupFlowController(stack: CoreDataStack) -&gt; FlowController {
    return FlowController(coreDataStack: stack)
  }
  
  static func SetupWindow(controller: UIViewController) -&gt; UIWindow {
    let window = UIWindow(frame: UIScreen.mainScreen().bounds)
    window.backgroundColor = UIColor.whiteColor()
    window.rootViewController = controller
    window.makeKeyAndVisible()
    return window
  }
}
</code></pre>
<p>è¿™æ˜¯æˆ‘ç°åœ¨æœ€å–œæ¬¢çš„æ–¹å¼ï¼š</p>
<ul>
<li>ç¡®ä¿ä¸å¯å˜çš„å±æ€§</li>
<li>ä¸ä¼šæœ‰å‰¯ä½œç”¨</li>
<li>éå¸¸æ•´æ´å¹¶ä¸”ä¸ä¼šæœ‰ç¼–è¯‘é”™è¯¯</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>è¿˜æœ‰ä¸€äº› Twitter ä¸Šçš„æœ‹å‹æ¨èçš„å…¶ä»–æ–¹æ³•ï¼Œ<a href="https://gist.github.com/krzysztofzablocki/6a1b6afab974f442f5ff">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°</a></p>
<p>æˆ‘ä¹Ÿæ˜¯æ‰åˆšåˆšå¼€å§‹å­¦ <code>Swift</code>ï¼Œæˆ‘å¿…é¡»è¯´æˆ‘è¶Šæ¥è¶Šå–œæ¬¢å®ƒï¼Œå°¤å…¶æ˜¯ <code>Swift 2.0</code>ã€‚</p>
<p>åœ¨æœ‰äº†20å¹´çš„ç¼–ç¨‹ç»å†ä¹‹åï¼Œé‡æ–°å˜æˆæ–°æ‰‹å¾ˆæœ‰è¶£ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰ä¼Ÿå¤§çš„æ„¿æ„åˆ†äº«çŸ¥è¯†çš„ç¤¾åŒºã€‚</p>
<p>éå¸¸æ„Ÿè°¢ <a href="http://twitter.com/jessyMeow">@jessyMeow</a> å’Œ <a href="http://twitter.com/KostiaKoval">@KostiaKoval</a> æŒ‡å‡ºæ¯”æˆ‘åŸæ¥æ–¹æ³•æ›´å¥½çš„æ–¹æ³• ğŸ˜ƒ</p>
<p>å¦‚æœä½ æœ‰ä½ å–œæ¬¢çš„æ–¹æ³•ï¼Œè¯·åœ¨ Twitter ä¸Šè®©æˆ‘çŸ¥é“ï¼Œæˆ‘å¾ˆæ„¿æ„å­¦ä¹ ï¼</p>
<p><a href="https://twitter.com/intent/follow?original_referer=http%3A%2F%2Fmerowing.info%2F2015%2F11%2Fswift-init%2F&amp;ref_src=twsrc%5Etfw&amp;region=follow_link&amp;screen_name=merowing_&amp;tw_p=followbutton">Follow @merowing_ on Twitter</a></p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">ä¸‹ä¸€ç¯‡</div>
                <a href="https://lzhenhong.github.io/post/xiang-jie-property/" class="post-title gt-a-link">
                    è¯¦è§£ property
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first"></div>
    <div class="social-container">
        
            
                <a href="https://github.com/LZhenHong" target="_blank">
                    <i class="fab fa-github gt-c-content-color-first"></i>
                </a>
            
        
            
                <a href="https://twitter.com/yys_RySn" target="_blank">
                    <i class="fab fa-twitter gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://lzhenhong.github.io/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
